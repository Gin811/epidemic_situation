"use strict";(self["webpackChunkepidemic_management_vue"]=self["webpackChunkepidemic_management_vue"]||[]).push([[476],{476:function(e,t,a){a.r(t),a.d(t,{default:function(){return n}});var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("健康码管理")]),a("el-breadcrumb-item",{attrs:{to:{path:"/personalcode"}}},[e._v("健康码详情")])],1),a("el-card",[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:8}},[a("el-input",{staticClass:"input-with-select",attrs:{clearable:"",placeholder:"请输入内容"},on:{clear:e.getCodeList},model:{value:e.queryInfo,callback:function(t){e.queryInfo=t},expression:"queryInfo"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.searchCodeByName},slot:"append"})],1)],1),a("el-col",{attrs:{span:5}},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addVisible=!0}}},[e._v("添加数据")]),a("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.batchDelete(e.tableChecked)}}},[e._v("批量删除")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{"cell-style":e.rowClass,data:e.CodeList,"header-cell-style":e.headClass,"row-style":e.rowStyle,border:""},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),a("el-table-column",{attrs:{label:"序号",prop:"id",width:"45px"}}),a("el-table-column",{attrs:{label:"姓名",prop:"username",width:"80px"}}),a("el-table-column",{attrs:{label:"电话",prop:"mobile",width:"110"}}),a("el-table-column",{attrs:{label:"住址",prop:"address",width:"100px"}}),a("el-table-column",{attrs:{label:"健康码"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"30px",height:"30px"},attrs:{"preview-src-list":[e.row.code_url],src:e.row.code_url}},[a("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"}),a("i",{staticClass:"el-icon-picture-outline"})])]}}])}),a("el-table-column",{attrs:{label:"上传时间",prop:"date"}}),a("el-table-column",{scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-radio",{attrs:{label:"未审核"},on:{change:function(a){return e.choose(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},[e._v("未审核")]),a("el-radio",{attrs:{label:"已审核"},on:{change:function(a){return e.choose(t.row)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},[e._v("已审核")])]}}])}),a("el-table-column",{attrs:{label:"操作",width:"100px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tooltip",{staticClass:"item",attrs:{content:"删除",effect:"dark",placement:"top-start"}},[a("el-button",{attrs:{circle:"",icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(a){return e.deleteCode(t.row)}}})],1),a("el-tooltip",{staticClass:"item",attrs:{content:"转为隔离",effect:"dark",placement:"top-start"}},[a("el-button",{attrs:{circle:"",icon:"el-icon-plus",size:"mini",type:"primary"},on:{click:function(a){return e.addDivide(t.row)}}})],1)]}}])})],1),a("el-pagination",{attrs:{"current-page":e.pageNum,"page-size":e.pageSize,"page-sizes":[5,8,10,12,15],total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),a("el-dialog",{attrs:{visible:e.addVisible,title:"增加数据",width:"35%"},on:{"update:visible":function(t){e.addVisible=t},close:e.closeAddDialog}},[a("el-form",{ref:"addFormRef",staticClass:"demo-Info",attrs:{model:e.Code,rules:e.mobileFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"电话",prop:"mobile"}},[a("el-input",{model:{value:e.Code.mobile,callback:function(t){e.$set(e.Code,"mobile",t)},expression:"Code.mobile"}})],1),a("el-form-item",{attrs:{label:"住址",prop:"address"}},[a("el-input",{model:{value:e.Code.address,callback:function(t){e.$set(e.Code,"address",t)},expression:"Code.address"}})],1),a("el-form-item",{attrs:{label:"选择日期时间",prop:"date"}},[a("el-date-picker",{staticStyle:{float:"left"},attrs:{placeholder:"选择日期时间",size:"large",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.Code.date,callback:function(t){e.$set(e.Code,"date",t)},expression:"Code.date"}})],1),a("el-form-item",{attrs:{label:"上传健康码"}},[a("el-upload",{staticStyle:{float:"left"},attrs:{"auto-upload":!1,limit:1,"on-change":e.uploadListChange,action:"","list-type":"picture-card"}},[a("i",{staticClass:"el-icon-plus"})])],1)],1),a("el-button",{on:{click:function(t){e.addVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.addCode}},[e._v("确 定")])],1),a("el-dialog",{attrs:{visible:e.addDivideVisible,title:"添加数据",width:"35%"},on:{"update:visible":function(t){e.addDivideVisible=t},close:e.closeAddDivideDialog}},[a("el-form",{ref:"addFormRef",staticClass:"demo-user",attrs:{model:e.Divide,rules:e.mobileFormRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"姓名",prop:"username"}},[a("el-input",{model:{value:e.Divide.username,callback:function(t){e.$set(e.Divide,"username",t)},expression:"Divide.username"}})],1),a("el-form-item",{attrs:{label:"电话：",prop:"mobile"}},[a("el-input",{model:{value:e.Divide.mobile,callback:function(t){e.$set(e.Divide,"mobile",t)},expression:"Divide.mobile"}})],1),a("el-form-item",{attrs:{label:"隔离地点：",prop:"area"}},[a("el-input",{model:{value:e.Divide.area,callback:function(t){e.$set(e.Divide,"area",t)},expression:"Divide.area"}})],1),a("el-form-item",{attrs:{label:"体温：",prop:"tw"}},[a("el-input",{staticStyle:{width:"100px",float:"left"},model:{value:e.Divide.tw,callback:function(t){e.$set(e.Divide,"tw",t)},expression:"Divide.tw"}}),a("div",{staticStyle:{float:"left"}},[e._v("°C")])],1),a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"症状1："}},[a("el-checkbox",{attrs:{prop:"status1","true-label":"咳嗽："},model:{value:e.Divide.status1,callback:function(t){e.$set(e.Divide,"status1",t)},expression:"Divide.status1"}},[e._v("咳嗽")])],1),a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"症状2："}},[a("el-checkbox",{attrs:{prop:"status2","true-label":"感冒"},model:{value:e.Divide.status2,callback:function(t){e.$set(e.Divide,"status2",t)},expression:"Divide.status2"}},[e._v("感冒")])],1),a("el-form-item",{staticStyle:{float:"left"},attrs:{label:"症状3："}},[a("el-checkbox",{staticStyle:{float:"left"},attrs:{prop:"status3","true-label":"发烧"},model:{value:e.Divide.status3,callback:function(t){e.$set(e.Divide,"status3",t)},expression:"Divide.status3"}},[e._v("发烧")])],1),a("el-form-item",{attrs:{label:"备注：",prop:"bz"}},[a("el-input",{model:{value:e.Divide.bz,callback:function(t){e.$set(e.Divide,"bz",t)},expression:"Divide.bz"}})],1),a("el-form-item",{attrs:{label:"隔离日期：",prop:"createTime"}},[a("el-date-picker",{staticStyle:{float:"left"},attrs:{placeholder:"选择日期时间",size:"large",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.Divide.createTime,callback:function(t){e.$set(e.Divide,"createTime",t)},expression:"Divide.createTime"}})],1)],1),a("el-button",{on:{click:function(t){e.addDivideVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.ConfirmAddDivide}},[e._v("确 定")])],1)],1)},s=[],l=(a(1703),{name:"PersonalCode",data(){const e=(e,t,a)=>{const i=/^1[345789]\d{9}$/;if(i.test(t))return a();a(new Error("请输入合法的手机号码"))};return{pageNum:1,pageSize:5,total:null,queryInfo:"",addVisible:!1,tableChecked:[],CodeList:[],Code:{},id:null,Divide:{},addDivideVisible:!1,codeFormData:"",status:"",mobileFormRules:{mobile:[{validator:e,trigger:"blur"}]}}},methods:{handleSelectionChange(e){console.log(e),this.tableChecked=e},headClass(){return"text-align:center"},rowClass(){return"text-align:center"},rowStyle({row:e}){if("未审核"===e.status)return{backgroundColor:"#dddcd6"}},handleSizeChange(e){this.pageSize=e,this.getCodeList()},handleCurrentChange(e){this.pageNum=e,this.getCodeList()},getCodeList(){this.$axios.get("/admin/code/getAllCodeList",{params:{pageNum:this.pageNum,pageSize:this.pageSize}}).then((e=>{this.CodeList=e.data.data.list,this.total=e.data.data.total}))},searchCodeByName(){this.$axios.post("/code/search?userName="+this.queryInfo).then((e=>{console.log(e),this.CodeList=e.data.data,this.total=e.data.data.length}))},choose(e){this.$axios.post("/code/updateStatus",e).then((e=>{1e4===e.data.status?this.$message.success("更新成功！"):this.$message.error("更新失败！")}))},closeAddDialog(){this.$refs.addFormRef.resetFields()},uploadListChange:function(e,t){let a=new FormData;t.forEach((e=>{a.append("file",e.raw)})),this.codeFormData=a},addCode(){this.$refs.addFormRef.validate((e=>{e?this.$axios.post("/code/oosFile/upload",this.codeFormData).then((e=>{console.log(e,"上传图片的结果"),200===e.data.code?(this.Code.codeUrl=e.data.data,console.log(this.Code),this.$axios.post("/code/add",this.Code).then((e=>{console.log(e,"添加到数据库之后的结果"),1e4===e.data.status?(this.$message.success("添加成功！"),this.addVisible=!1):this.$message.error("添加失败！")}))):this.$message.error("添加失败！")})):alert("请输入正确的信息")}))},editCode(e){console.log(e)},closeEditDialog(){this.$refs.addFormRef.resetFields()},deleteCode(e){this.$confirm("此操作将永久删除该商品, 是否继续?","删除商品",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.get("/code/delete?id="+e.id).then((e=>{console.log(e),1e4===e.data.status?(this.$message.success("删除成功！"),this.getGoodsList()):this.$message.error("删除失败")}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},batchDelete(e){console.log(e)},addDivide(e){this.addDivideVisible=!0,this.Divide.username=e.username,this.Divide.mobile=e.mobile,this.id=e.id},ConfirmAddDivide(){this.Divide.tw=this.Divide.tw+"°C",this.$axios.post("/divide/add",this.Divide).then((e=>{1e4===e.data.status?this.$axios.get("/code/delete?id="+this.id).then((e=>{1e4===e.data.status?(this.$message.success("转移成功！"),this.getCodeList()):(this.$message.error("转移失败！删除出错"),this.getCodeList())})):(this.$message.error("转移失败！添加到隔离人员失败！"),this.getCodeList()),this.addDivideVisible=!1}))},closeAddDivideDialog(){this.$refs.addFormRef.resetFields()}},created(){this.getCodeList()}}),o=l,r=a(1001),d=(0,r.Z)(o,i,s,!1,null,"15836d00",null),n=d.exports}}]);
//# sourceMappingURL=476.c69ca748.js.map