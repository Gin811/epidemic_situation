"use strict";(self["webpackChunkepidemic_management_vue"]=self["webpackChunkepidemic_management_vue"]||[]).push([[428],{9428:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[s("el-breadcrumb-item",{attrs:{to:{path:"/home"}}},[e._v("首页")]),s("el-breadcrumb-item",[e._v("系统管理")]),s("el-breadcrumb-item",{attrs:{to:{path:"/users"}}},[e._v("角色列表")])],1),s("el-card",[s("el-row",{attrs:{gutter:15}},[s("el-col",{attrs:{span:8}},[s("el-input",{staticClass:"input-with-select",attrs:{clearable:"",placeholder:"请输入内容"},on:{clear:e.getUserList},model:{value:e.queryInfo.username,callback:function(t){e.$set(e.queryInfo,"username",t)},expression:"queryInfo.username"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.getUserList},slot:"append"})],1)],1),s("el-col",{attrs:{span:5}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addUserVisible=!0}}},[e._v("添加用户")]),s("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.batchDelete(e.tableChecked)}}},[e._v("批量删除")])],1)],1),s("el-table",{staticStyle:{width:"100%"},attrs:{data:e.userList,border:"","cell-style":e.rowClass,"header-cell-style":e.headClass,"row-style":e.rowStyle},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),s("el-table-column",{attrs:{label:"序号",type:"index",width:"50"}}),s("el-table-column",{attrs:{label:"姓名",prop:"username",width:"180"}}),s("el-table-column",{attrs:{label:"电话",prop:"mobile"}}),s("el-table-column",{attrs:{label:"邮箱",prop:"email"}}),s("el-table-column",{attrs:{label:"角色",prop:"status",width:"160px"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-switch",{attrs:{"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},on:{change:function(s){return e.changeStatus(t.row)}},model:{value:t.row.status,callback:function(s){e.$set(t.row,"status",s)},expression:"scope.row.status"}})]}}])}),s("el-table-column",{attrs:{label:"创建时间",prop:"createTime"}}),s("el-table-column",{attrs:{label:"住址",prop:"address"}}),s("el-table-column",{attrs:{label:"操作",prop:"salt"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tooltip",{staticClass:"item",attrs:{content:"编辑",effect:"dark",placement:"top-start"}},[s("el-button",{attrs:{circle:"",icon:"el-icon-edit",size:"mini",type:"primary"},on:{click:function(s){return e.editUser(t.row)}}})],1),s("el-tooltip",{staticClass:"item",attrs:{content:"删除",effect:"dark",placement:"top-start"}},[s("el-button",{attrs:{circle:"",icon:"el-icon-delete",size:"mini",type:"danger"},on:{click:function(s){return e.removeUserItem(t.row.userId)}}})],1),s("el-tooltip",{staticClass:"item",attrs:{content:"分配角色",effect:"dark",placement:"top-start"}},[s("el-button",{attrs:{circle:"",icon:"el-icon-setting",size:"mini",type:"primary"},on:{click:function(s){return e.assignRoles(t.row)}}})],1)]}}])})],1),s("el-pagination",{attrs:{"current-page":e.queryInfo.pageNum,"page-size":e.queryInfo.pageSize,"page-sizes":[6,8,10,12,15],total:e.total,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),s("el-dialog",{attrs:{visible:e.addUserVisible,title:"添加用户",width:"35%"},on:{"update:visible":function(t){e.addUserVisible=t},close:e.closeAddUserDialog}},[s("el-form",{ref:"addUserFormRef",staticClass:"demo-user",attrs:{model:e.user,rules:e.addUserFormRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),s("el-form-item",{attrs:{label:"密码",prop:"password"}},[s("el-input",{attrs:{autocomplete:"off",type:"password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),s("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[s("el-input",{model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"status"}},[s("el-radio-group",{model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}},[s("el-radio",{attrs:{label:0}},[e._v("禁用")]),s("el-radio",{attrs:{label:1}},[e._v("用户")]),s("el-radio",{attrs:{label:2}},[e._v("管理员")])],1)],1),s("el-form-item",{attrs:{label:"住址",prop:"address"}},[s("el-input",{model:{value:e.user.address,callback:function(t){e.$set(e.user,"address",t)},expression:"user.address"}})],1),s("el-form-item",{attrs:{label:"选择时间：",prop:"createTime"}},[s("el-date-picker",{staticStyle:{float:"left"},attrs:{prop:"createTime",placeholder:"选择日期时间",size:"large",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.user.createTime,callback:function(t){e.$set(e.user,"createTime",t)},expression:"user.createTime"}})],1)],1),s("el-button",{on:{click:function(t){e.addUserVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.addUser}},[e._v("确 定")])],1),s("el-dialog",{attrs:{visible:e.editUserVisible,title:"修改用户",width:"35%"},on:{"update:visible":function(t){e.editUserVisible=t},close:e.closeEditUserDialog}},[s("el-form",{ref:"editUserFormRef",staticClass:"demo-user",attrs:{model:e.user,rules:e.editUserFormRules,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"用户名",prop:"username"}},[s("el-input",{model:{value:e.user.username,callback:function(t){e.$set(e.user,"username",t)},expression:"user.username"}})],1),s("el-form-item",{attrs:{label:"手机号码",prop:"mobile"}},[s("el-input",{model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),s("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[s("el-input",{model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),s("el-form-item",{attrs:{label:"角色",prop:"status"}},[s("el-input",{model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}})],1),s("el-form-item",{attrs:{label:"住址",prop:"address"}},[s("el-input",{model:{value:e.user.address,callback:function(t){e.$set(e.user,"address",t)},expression:"user.address"}})],1),s("el-form-item",{attrs:{label:"住址",prop:"address"}},[s("el-date-picker",{staticStyle:{float:"left"},attrs:{placeholder:"选择日期时间",size:"large",type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"},model:{value:e.user.createTime,callback:function(t){e.$set(e.user,"createTime",t)},expression:"user.createTime"}})],1)],1),s("el-button",{on:{click:function(t){e.editUserVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateUser}},[e._v("确 定")])],1),s("el-dialog",{attrs:{visible:e.assignRolesVisible,title:"分配角色",width:"35%"},on:{"update:visible":function(t){e.assignRolesVisible=t}}},[s("el-radio-group",{model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}},[s("el-radio",{attrs:{label:0}},[e._v("禁用")]),s("el-radio",{attrs:{label:1}},[e._v("用户")]),s("el-radio",{attrs:{label:2}},[e._v("管理员")])],1),s("el-form",{ref:"assignRolesFormRef",staticClass:"demo-user",attrs:{model:e.user,"label-width":"100px"}},[s("el-form-item",{staticStyle:{display:"inline-block"},attrs:{label:"角色",prop:"status"}},[s("el-input",{staticStyle:{float:"left",width:"250px"},model:{value:e.user.status,callback:function(t){e.$set(e.user,"status",t)},expression:"user.status"}})],1)],1),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.assignRolesVisible=!1}}},[e._v("取 消")]),s("el-button",{attrs:{type:"primary"},on:{click:e.updateRolesStatus}},[e._v("确 定")])],1)],1)],1)},r=[],i=(s(1703),{name:"User",data(){const e=(e,t,s)=>{const a=/^\w+@\w+(\.\w+)+$/;if(a.test(t))return s();s(new Error("请输入合法的邮箱"))},t=(e,t,s)=>{const a=/^1[345789]\d{9}$/;if(a.test(t))return s();s(new Error("请输入合法的手机号码"))};return{tableChecked:[],ids:[],queryInfo:{username:"",pageNum:1,pageSize:6},userList:[],total:0,user:{userId:"",username:"",password:"",email:"",mobile:"",status:"",createUserId:"",createTime:""},addUserVisible:!1,addUserFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:2,max:6,message:"长度在 3 到 5 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:10,message:"长度在 3 到 5 个字符",trigger:"blur"}],mobile:[{validator:t,trigger:"blur"}],email:[{validator:e,trigger:"blur"}],status:[{required:!0,message:"请输入当前角色",trigger:"blur"}],createUserId:[{required:!0,message:"请输入创建者Id",trigger:"blur"},{min:3,max:9,message:"长度在 3 到 9 个字符",trigger:"blur"}]},editUserVisible:!1,editUserFormRules:{mobile:[{validator:t,trigger:"blur"}],email:[{validator:e,trigger:"blur"}]},assignRolesVisible:!1}},methods:{rowStyle({row:e}){if(0===e.status)return{backgroundColor:"#D7DBDD"}},headClass(){return"text-align:center"},rowClass(){return"text-align:center"},handleSelectionChange(e){this.tableChecked=e},batchDelete(e){const t=e[0].status;e.forEach(((e,t)=>{this.ids.push(e.userId)})),this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((()=>{this.$axios.post("/admin/batchDeleteEgressUser?status="+t,this.ids).then((e=>{1e4!==e.data.status&&this.$message.error("删除失败！"),this.$message({type:"success",message:"删除成功!"}),this.getUserList(),console.log("删除了",this.ids),this.ids=[]})).catch((e=>{this.$message({type:"info",message:"已取消删除"})}))}))},getUserList(){this.$axios.get("/admin/user/userList",{params:this.queryInfo}).then((e=>{void 0!==e.data.data.total?1e4===e.data.status?(this.total=e.data.data.total,this.userList=e.data.data.list,this.$message.success("请求用户列表成功！")):this.$message.error("请求用户列表失败！"):1e4===e.data.status?(this.total=1,this.userList=[],this.userList.push(e.data.data),this.$message.success("搜索用户成功！")):this.$message.error("搜索用户失败！")}))},handleSizeChange(e){this.queryInfo.pageSize=e,this.getUserList()},handleCurrentChange(e){this.queryInfo.pageNum=e,this.getUserList()},changeStatus(e){this.user=e,this.$axios.post("/admin/user/update",this.user).then((e=>{1e4===e.data.status?this.$message.success("更新用户角色成功！"):this.$message.error("更新用户角色失败！")}))},addUser(){this.$refs["addUserFormRef"].validate((e=>{if(!e)return alert("请输入正确的信息！");this.$axios.post("/user/add",this.user).then((e=>{1e4===e.data.status?(this.addUserVisible=!this.addUserVisible,this.$message.success("新增用户成功！"),this.getUserList()):(this.addUserVisible=!this.addUserVisible,this.$message.error("新增用户失败！"))}))}))},closeAddUserDialog(){this.$refs["addUserFormRef"].resetFields()},editUser(e){this.user=e,this.editUserVisible=!this.editUserVisible},updateUser(){this.$refs["editUserFormRef"].validate((e=>{if(!e)return alert("请输入正确的信息！");this.$axios.post("/admin/user/update",this.user).then((e=>{this.$message.success("修改用户信息成功！"),this.getUserList(),this.editUserVisible=!this.editUserVisible}))}))},closeEditUserDialog(){this.$refs.editUserFormRef.resetFields()},removeUserItem(e){console.log(e),this.$confirm("此操作将永久删除该用户, 是否继续?","删除用户",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$axios.post("/admin/user/delete/"+e).then((e=>{console.log(e),this.$message.success("删除用户成功！"),this.getUserList()}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},assignRoles(e){this.user=e,this.assignRolesVisible=!this.assignRolesVisible},updateRolesStatus(){this.$axios.post("/admin/user/update",this.user).then((e=>{this.assignRolesVisible=!this.assignRolesVisible,this.getUserList()}))}},created(){this.getUserList()}}),l=i,o=s(1001),n=(0,o.Z)(l,a,r,!1,null,"904caff2",null),u=n.exports}}]);
//# sourceMappingURL=428.06567d67.js.map